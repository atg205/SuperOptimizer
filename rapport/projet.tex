\documentclass[10pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage[french]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{svg}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\author{Karim ELLOUZE, Philipp HANUSSEK}
\title{Projet MOGPL : optimisation robuste dans l’incertain total}
\begin{document}
\maketitle
\newpage
\chapter{Linéarisation des critères maxmin et minmax regret}
\section{Programme linéare \textit{maxmin}}
\begin{align*}
\max \quad & t \\
\text{sous contraintes} \quad & t \leq \sum_{i=1}^{n} v_{i,1} x_i \\
& t \leq \sum_{i=1}^{n} v_{i,2} x_i \\
& \sum_{i=1}^{n} w_i x_i \leq W \\
& x_i \in \{0, 1\}, \quad \forall i = 1, \ldots, n
\end{align*}
Solution optimale trouvé avec Gurobi:
\begin{align*}
	x^* 	&= [2, 3, 4, 7, 8, 9]\\
	z(x^*) 	&= [66,66]
\end{align*}
\section{Programme linéaire \textit{minmax regret}}
\begin{align*}
\min \quad & t \\
\text{sous contraintes} \quad & t \geq z_1^* - \sum_{i=1}^{n} v_{i,1} x_i \\
& t \geq z_2^* - \sum_{i=1}^{n} v_{i,2} x_i \\
& \sum_{i=1}^{n} w_i x_i \leq W \\
& x_i \in \{0, 1\}, \quad \forall i = 1, \ldots, n
\end{align*}
$z_i^*$ étant la meilleure valeure pour le scénario i\\\\
Solution optimale trouvé avec Gurobi:
\begin{align*}
	x^{'*} 	&= [2, 3, 6, 7, 8, 9]\\
	z(x_1^*,x_2^*) &= [112,118]\\ 
	z(x^{'*}) 	&= [62,70]
\end{align*}
\section{Représentation dans le plan}
\section{Analyse de pérformance}
\begin{figure}[h!]
    \centering
    \includesvg[width=\linewidth]{figures/performance_ex1.svg}  
    \caption{Comparaison des temps d'exécution pour les modèles maxmin et minmax regret.}
    \label{fig:performance_ex1}
\end{figure}
\chapter{Linéarisation du critère \textit{maxOWA}}
\section{$L_k(z)$ comme valeur optimale}
\textbf{Explication :} Étant donné que le vecteur $(z_{(1)}, \ldots, z_{(n)})$ est ordonné en ordre croissant, la somme $\sum_{i=1}^{k} z(i)$ correspond à la somme des $k$ plus petites valeurs de $z_i$ et donc à la valeur optimale du programme linéaire.
\section{Utiliser le dual pour trouver les composantes du $L(z)$ }
Primal:

\begin{align*}
\min & \sum_{i=1}^{n} a_{ik} z_i \\
\text{s.c.} \quad & \sum_{i=1}^{n} a_{ik} = k \\
& 0 \leq a_{ik} \leq 1, \quad i = 1, \dots, n
\end{align*}

Dual:

\begin{align*}
\max & \quad k \cdot r_k - \sum_{i=1}^{n} b_{ik} \\
\text{s.c.} \quad & r_k - b_{ik} \leq z_i, \quad \forall i = 1, \dots, n \\
& b_{ik} \geq 0, \quad \forall i = 1, \dots, n
\end{align*}
Trouver $L(z)$ avec $z=[2,9,6,8,5,4]$ (voir le code pour calculation par programmation linéaire):
\begin{align*}
L_1(z)&= 2\\
L_2(z)&= 6\\
L_3(z)&= 11\\
L_4(z)&= 17\\
L_5(z)&= 25\\
L_6(z)&= 34\\
\end{align*}
\section{Reécrire l'OWA}
Montrer que 
\begin{align*}
g(x)& =\sum_{i=1}^{n}w_iz_{(i)}(x)\\
&=\sum_{k=1}^{n}w'_k L_k(z(x))
\end{align*}
\textbf{Explication:}
\begin{align*}
\text{par définition: }z_{(k)}(x)&=L_k(z(x)) - L_{k-1}(z(x))\\
g(x)& =\sum_{i=1}^{n}w_iz_{(i)}(x)\\
&=w_1z_{(1)}+w_2z_{(2)}+\ldots+w_nz_{(n)}\\
&=w_1L_1(z(x))+w_2(L_2(z(x))-L_1(z(x)))+\ldots+w_n(L_n(z(x))-L_{n-1}(z(x))\\
&=(w_1-w_2)L_1(z(x))+(w_2-w_3)(L_2(z(x)))+\ldots+(w_{n-1}-w_{n})L_n\\
&=\sum^n_{k=1}w'_kL_k(z(x))
\end{align*}
\section{Formulation \textit{maxOWA} pour le problème SAD}
\begin{align*}
&\max && \sum_{k=1}^n w'_k \left( k \cdot r_k - \sum_{i=1}^n b_{ik} \right) \\
&\text{s.c.} && r_k - b_{ik} \leq z_i(x)\\
&&& b_{ik} \geq 0\\
&&& \sum_{i=1}^{n} w_i x_i \leq W, \\
&&& x_i \in \{0, 1\}, \quad i = 1, \dots, n.
\end{align*}
Solution optimale trouvé avec Gurobi:
\begin{align*}
	x^{*} 	&= [2, 3, 4, 7, 8, 9]\\
	z(x^{*}) 	&= [66, 66]
\end{align*}
\section{Formulation linéaire pour le critère de \textit{minOWA}}
Primal:\\\\
$L_k(z)=\sum_{i=1}^{k} r(x,s_{(i)})$, regret en ordre décroissant, donc:\\
\begin{align*}
    \max &\sum_{i=1}^n a_{ik} r(x,s_{(i)})\\
\text{s.c.} \quad & \sum_{i=1}^{n} a_{ik} = k \\
& 0 \leq a_{ik} \leq 1, \quad i = 1, \dots, n
\end{align*}
$r(x,s_{(i)}) = z_i^*-z_i(x)$\\\\
Dual:
\begin{align*}
\min & \quad k \cdot r_k + \sum_{i=1}^{n} b_{ik} \\
\text{s.c.} \quad & r_k + b_{ik} \geq r(x,s_{(i)}), \quad \forall i = 1, \dots, n \\
& b_{ik} \geq 0, \quad \forall i = 1, \dots, n
\end{align*}\\\\
Formulation entière:
\begin{align*}
\min &\sum_{k=1}^n w'_k \left( k \cdot r_k + \sum_{i=1}^n b_{ik} \right) \\
\text{s.c.} & \quad r_k + b_{ik} \geq r(x,s_{(i)}), \quad i = 1, \dots, n \\
& \quad b_{ik} \geq 0, \quad i = 1, \dots, n \\
& \sum_{i=1}^{n} w_i x_i \leq W\\
&x_i\in\{0,1\}\quad \forall i=1, \dots,n
\end{align*}
Solution optimale trouvé avec Gurobi:
\begin{align*}
	x^{'*} 	&= [2, 4, 5, 7, 8, 9]\\
	z(x_1^*,x_2^*) &= [112,118]\\ 
	z(x^{'*}) 	&= [62,70]
\end{align*}
\section{Analyse de performance}
\begin{figure}[h!]
    \centering
    \includesvg[width=\linewidth]{figures/performance_ex2.svg}  
    \caption{Comparaison des temps d'exécution pour les modèles maxOWA et minOWA des regrets.}
    \label{fig:performance_ex2}
\end{figure}
\chapter{Application à la recherche d’un chemin robuste dans un graphe}
\section{Modelisation du problème de plus court chemin comme problème du flot de coût minimum}

$G=(V,E)$, source: $s \in V$, puit: $t \in V$

$a(u,v)$: cout pour passer de u à v, $f(u,v)=1$ si $(u,v) \in $ {plus court chemin}\\\\
Programme linéaire:
\begin{align*}
\min&\sum_{(u,v)\in E} a(u,v)f(u,v)&\\
s.c.& \sum_{(u,v)\in E}f(u,v) = \sum_{(v,w)\in E}f(v,w) \quad \forall v \in V \setminus \{s, t\}& \text{, contrainte de conservation du flux}\\
    & \sum_{s,v \in E} f(s,v) >= 1 &\text{ , contrainte de flux sortant de la source}\\
    &f(u,v)\in (0,1) \quad \forall (u,v) \in E&
\end{align*}
\section{Application aux exemples}
Solution optimale trouvé avec Gurobi pour l'instance 1:
\begin{align*}
	x_1^{*} 	&= [a, b, d, f]\\
	x_2^*		&= [a, c, d, f]\\
	z(x^{*}) 	&= [8, 4]
\end{align*}
Pour l'instance 2:
\begin{align*}
	x_1^{*} 	&= [a, d, c, f, g]\\
	x_2^*		&= [a, c, e, g]\\
	z(x^{*}) 	&= [5, 6]
\end{align*}
\section{Programmes linéaires pour trouver un chemin robuste}
$x$ est une solution valide si:
\begin{align*}
           & \sum_{(u,v)\in E}f(u,v) = \sum_{(v,w)\in E}f(v,w) \quad \forall v \in V \setminus \{s, t\}& \text{, contrainte de conservation du flux}\\
            & \sum_{s,v \in E} f(s,v) >= 1 &\text{ , contrainte de flux sortant de la source}&\\
            &f(u,v)\in \{0,1\} \quad \forall (u,v) \in E&
\end{align*}
\subsection*{\textit{minmax}}
Comme on veut trouver le plus court chemin, on calcule le \textit{min} des solutions maximales pour un chemin $X$.

Programme linéaire pour $n$ scénarios:
\begin{align*}
\min\quad   & t&&\\
s.c.\quad   &t\ge\sum_{(u,v)\in E} a_i(u,v)f(u,v)&i\in\{1,\ldots,n\}\\
                & x \in X\\
            &f(u,v)\in \{0,1\} \quad \forall (u,v) \in E&
\end{align*}
\subsection*{\textit{minmax} des regrets}
Programme linéaire pour $n$ scénarios:
\begin{align*}
\min\quad   & t&&\\
s.c.\quad   &t\ge\sum_{(u,v)\in E} \bigl(a_i(u,v)f(u,v)\bigl)-z_i^*&i\in\{1,\ldots,n\}\\
                & x \in X\\
            &f(u,v)\in \{0,1\} \quad \forall (u,v) \in E&
\end{align*}
\subsection*{\textit{minOWA}}
\begin{align*}
\min            &\sum_{k=1}^n w'_k \left( k \cdot r_k + \sum_{i=1}^n b_{ik} \right) \\
\text{s.c.}     & \quad r_k + b_{ik} \geq z_i(x) \quad i = 1,\ldots,n\\
                & x \in X\\
                & \quad b_{ik} \geq 0, \quad i = 1, \dots, n \\
\end{align*}
\subsection*{\textit{minOWA} des regrets}
\begin{align*}
\min &\sum_{k=1}^n w'_k \left( k \cdot r_k + \sum_{i=1}^n b_{ik} \right) \\
\text{s.c.} & \quad r_k + b_{ik} \geq r(x,s_{(i)}), \quad i = 1, \dots, n \\
& \quad b_{ik} \geq 0, \quad i = 1, \dots, n \\
& \quad x \in X
\end{align*}
\subsection*{Résultats}
\subsubsection{minMax et minMax des regrets}
\begin{table}[h!]
\centering
\renewcommand{\arraystretch}{1.5} % Augmente l'espacement vertical dans le tableau
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Instance} & \textbf{Méthode}        & \textbf{Chemin}  & \textbf{Valeur de la fonction objectif} & \textbf{Vecteur\_z} \\ \hline
\multirow{2}{*}{Instance 0} 
                  & minmax                  & a,b,d,f          & 9             & [8, 9]              \\ \cline{2-5}
                  & minMax des regrets      & a,b,e,f          & 3             & [11, 7]             \\ \hline
\multirow{2}{*}{Instance 1} 
                  & minmax                  & a,b,e,g          & 10            & [10, 10]            \\ \cline{2-5}
                  & minMax des regrets      & a,b,e,g          & 5             & [10, 10]            \\ \hline
\end{tabular}
\caption{Comparaison des résultats des méthodes minmax et minMax des regrets.}
\label{tab:resultats}
\end{table}
\subsubsection{minOWA et minOWA des regrets}
\begin{table}[h!]
\centering
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
\textbf{Méthode}        & \textbf{Instance} & \textbf{\(k\)} & \textbf{Chemin} & \textbf{\( \text{Vecteur\_z} \)} & \textbf{Valeur de la fonction objectif} \\ \hline
\multirow{8}{*}{minOWA} & \multirow{4}{*}{0} 
                        & 2  & a,b,d,f          & [8, 9]        & 26 \\ \cline{3-6} 
                        &                       & 4  & a,b,d,f          & [8, 9]        & 44 \\ \cline{3-6} 
                        &                       & 8  & a,b,d,f          & [8, 9]        & 80 \\ \cline{3-6} 
                        &                       & 16 & a,b,d,f          & [8, 9]        & 152 \\ \cline{2-6} 
                        & \multirow{4}{*}{1} 
                        & 2  & a,b,e,g          & [10, 10]      & 30 \\ \cline{3-6} 
                        &                       & 4  & a,b,e,g          & [10, 10]      & 50 \\ \cline{3-6} 
                        &                       & 8  & a,b,e,g          & [10, 10]      & 90 \\ \cline{3-6} 
                        &                       & 16 & a,b,e,g          & [10, 10]      & 170 \\ \hline
\multirow{8}{*}{minOWA des regrets} 
                        & \multirow{4}{*}{0} 
                        & 2  & a,b,e,f          & [11, 7]       & 9 \\ \cline{3-6} 
                        &                       & 4  & a,b,e,f          & [11, 7]       & 15 \\ \cline{3-6} 
                        &                       & 8  & a,b,e,f          & [11, 7]       & 27 \\ \cline{3-6} 
                        &                       & 16 & a,b,e,f          & [11, 7]       & 51 \\ \cline{2-6} 
                        & \multirow{4}{*}{1} 
                        & 2  & a,d,f,g          & [6, 12]       & 13 \\ \cline{3-6} 
                        &                       & 4  & a,b,e,g          & [10, 10]      & 24 \\ \cline{3-6} 
                        &                       & 8  & a,b,e,g          & [10, 10]      & 44 \\ \cline{3-6} 
                        &                       & 16 & a,b,e,g          & [10, 10]      & 84 \\ \hline
\end{tabular}
\caption{Comparaison des méthodes minOWA et minOWA des regrets.}
\label{tab:methods}
\end{table}
\begin{table}[h!]
\centering
\begin{tabular}{|c|c|c|}
\hline
Instance & \( z^* \) \\
\hline
0 & [8, 4] \\
1 & [5, 6] \\
\hline
\end{tabular}
\caption{Valeurs de \( z^* \) pour chaque instance}
\label{tab:z_star}
\end{table}

\end{document}
